# Secure Multi-Party Computation Framework (Client/Server)

## Overview

This project implements a secure client-server system demonstrating cryptographic authentication  It serves as a practical example of combining network programming, cryptography.

## Features

 Client-Server Architecture: TCP/IP communication using Boost.Asio.
 Secure Authentication: ECDSA (secp256k1) based challenge-response protocol.
     Client authenticated using a pre-provisioned private key and serial ID.
     Server authenticated using its private key.
 Cryptography: Uses Trezor Crypto library for ECDSA, SHA256, and underlying elliptic curve operations (secp256k1).
 Serialization: Uses Nanopb (Protocol Buffers for C) for efficient message encoding/decoding.
 Build System: Uses CMake for cross-platform configuration and building.
 Directory Structure: Organized source, include, external library, and build directories.

## Directory Structure

.
├── CMakeLists.txt        # Main CMake configuration file
├── README.md             # This file
├── src/                  # C++ source files (.cpp)
│   ├── client.cpp
│   ├── crypto_utils.cpp
│   ├── nanopb_utils.cpp
│   ├── network_utils.cpp
│   ├── server.cpp
├── include/              # C++ header files (.h)
│   ├── crypto_utils.h
│   ├── nanopb_utils.h
│   ├── network_utils.h
├── proto/                # Protocol buffer definitions & generated files
│   ├── auth.proto
│   ├── auth.pb.c         # Generated by nanopb
│   └── auth.pb.h         # Generated by nanopb
├── external/             # External library sources (via git clone)
│   ├── nanopb/           # Cloned nanopb repository
│   └── trezor-firmware/  # Cloned trezor-crypto repository (part of firmware)
├── keys/                 # Runtime directory for key files (needs creation)
│   ├── client_private_key.bin # (Needs generation)
│   ├── client_public_key.bin  # (Needs generation)
│   ├── server_private_key.bin # (Needs generation)
│   └── server_public_key.bin  # (Generated by server on first run if missing)
└── _build/               # Build directory (created by user)
├── bin/              # Compiled executables
└── ...               # CMake cache, object files, etc.



## Prerequisites

Before building and running, ensure you have the following installed:

1.  CMake: Version 3.10 or higher.
     Check: `cmake --version`
     Install (Ubuntu/Debian): `sudo apt update && sudo apt install cmake`
     Install (Other): See [CMake Download Page](https://cmake.org/download/)

2.  Boost Libraries: Version 1.74 or higher, specifically the System component (for Boost.Asio). Header-only parts are used, but linking requires the compiled System library.
     Check: Look for Boost headers/libs in `/usr/include`, `/usr/lib`, `/opt`, or `/usr/local`.
     Install (Ubuntu/Debian): `sudo apt install libboost-dev libboost-system-dev`
     Manual Install: Download from [Boost Website](https://www.boost.org/), build, and install. You might need to tell CMake where to find it by setting `BOOST_ROOT` or using `-DBOOST_ROOT=/path/to/boost` during the `cmake ..` step if it's not found automatically. The `CMakeLists.txt` currently points to `/opt/boost_1_74_0/`. Adjust this path in `CMakeLists.txt` if your Boost installation is elsewhere.

3.  Python: Version 3.9.x required for the Nanopb generator script.
     Check: `python3 --version`
     Install (Ubuntu/Debian): `sudo apt install python3`

## Building the Project

1.  Clone this Repository:
    git clone <your-repo-url> secure-mcp-framework
    cd secure-mcp-framework

2.  Clone External Dependencies: Clone the required versions of Nanopb and Trezor Crypto into the `external/` directory.
    mkdir external
    cd external

    # Clone Nanopb (check for a specific release tag if needed)
    git clone [https://github.com/nanopb/nanopb.git]

    # Clone Trezor Firmware (contains trezor-crypto)
    git clone [https://github.com/trezor/trezor-firmware.git]

    cd ..
    # Should now have external/nanopb and external/trezor-firmware

3.  Configure with CMake: Create a build directory and run CMake.
    mkdir _build
    cd _build
    # If Boost is installed in a non-standard location, add: -DBOOST_ROOT=/path/to/boost_1_XX_X
    cmake ..
    Review the CMake output to ensure Boost and Python were found correctly.

4.  Compile:
    cmake --build .
	
    Executables (server, client) will be placed in `_build/bin/`.

## Generating Keys

The client and server require ECDSA (secp256k1) key pairs stored in specific binary formats in the `keys/` directory. You must generate these before running.

keys/client_private_key.bin`: 32 raw bytes of the client's private key.
keys/server_private_key.bin`: 32 raw bytes of the server's private key.
keys/client_public_key.bin`: 65 bytes - the uncompressed public key (0x04 + 32-byte X + 32-byte Y) corresponding to the client's private key.
keys/server_public_key.bin`: 65 bytes - the uncompressed public key for the server. (The server code will attempt to generate this from `server_private_key.bin` if it's missing, but it's better to generate all keys beforehand).

Note: Ensure the client public key filename (client_public_key.bin) matches the configuration in src/server.cpp (currently hardcoded for CLIENT_SN_001).

Running

    Start the Server: Open a terminal, navigate to the project root directory (secure-mcp-framework), and run:
	
	./_build/bin/server
	
	The server will wait for connections.

Start the Client: Open a second terminal, navigate to the project root directory, and run:
./_build/bin/client

External Dependencies

    Boost: (https://www.boost.org/) Used for Asio (Networking). Requires Boost.System library.
    Trezor Crypto: (https://github.com/trezor/trezor-firmware/tree/master/crypto) Used for ECDSA, SHA256, bignum, secp256k1 operations. Cloned from the trezor-firmware repository.
    Nanopb: (https://github.com/nanopb/nanopb) Used for Protocol Buffers C implementation (serialization).